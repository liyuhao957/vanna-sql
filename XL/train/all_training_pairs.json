[
  {
    "question": "统计过去30天内各类事件的数量分布",
    "sql": "SELECT event, COUNT(*) as event_count\nFROM ods_RealTime_pcc_quickapp_events\nWHERE timed >= DATE_SUB(CURRENT_DATE(), INTERVAL 30 DAY)\nGROUP BY event\nORDER BY event_count DESC;"
  },
  {
    "question": "分析不同设备品牌的广告点击率",
    "sql": "SELECT \n    brand, \n    COUNT(*) as impression_count,\n    SUM(CASE WHEN event = 'clk' THEN 1 ELSE 0 END) as click_count,\n    SUM(CASE WHEN event = 'clk' THEN 1 ELSE 0 END) / COUNT(*) as ctr\nFROM ods_RealTime_pcc_quickapp_events\nWHERE timed = '2025-04-15' AND event IN ('imp', 'clk')\nGROUP BY brand\nORDER BY impression_count DESC\nLIMIT 20;"
  },
  {
    "question": "查找点击量最高的10个广告源",
    "sql": "SELECT \n    ggSource,\n    COUNT(*) as click_count\nFROM ods_RealTime_pcc_quickapp_events\nWHERE timed = '2025-04-15' AND event = 'clk'\nGROUP BY ggSource\nORDER BY click_count DESC\nLIMIT 10;"
  },
  {
    "question": "统计不同地区用户的分布情况",
    "sql": "SELECT \n    regionName,\n    COUNT(DISTINCT userId) as user_count\nFROM ods_RealTime_pcc_quickapp_events\nWHERE timed = '2025-04-15' AND regionName IS NOT NULL\nGROUP BY regionName\nORDER BY user_count DESC;"
  },
  {
    "question": "分析不同时间段的用户活跃度",
    "sql": "SELECT \n    HOUR(timedt) as hour_of_day,\n    COUNT(DISTINCT userId) as active_users\nFROM ods_RealTime_pcc_quickapp_events\nWHERE timed = '2025-04-15'\nGROUP BY HOUR(timedt)\nORDER BY hour_of_day;"
  },
  {
    "question": "查询广告展示与点击的时间趋势",
    "sql": "SELECT \n    timed,\n    SUM(CASE WHEN event = 'imp' THEN 1 ELSE 0 END) as impressions,\n    SUM(CASE WHEN event = 'clk' THEN 1 ELSE 0 END) as clicks,\n    SUM(CASE WHEN event = 'clk' THEN 1 ELSE 0 END) / NULLIF(SUM(CASE WHEN event = 'imp' THEN 1 ELSE 0 END), 0) as ctr\nFROM ods_RealTime_pcc_quickapp_events\nWHERE timed BETWEEN '2025-03-15' AND '2025-04-15' AND event IN ('imp', 'clk')\nGROUP BY timed\nORDER BY timed;"
  },
  {
    "question": "找出错误率最高的广告类型",
    "sql": "SELECT \n    ggType,\n    COUNT(*) as total_requests,\n    SUM(CASE WHEN event = 'err' THEN 1 ELSE 0 END) as error_count,\n    SUM(CASE WHEN event = 'err' THEN 1 ELSE 0 END) / COUNT(*) as error_rate\nFROM ods_RealTime_pcc_quickapp_events\nWHERE timed = '2025-04-15'\nGROUP BY ggType\nHAVING COUNT(*) > 100\nORDER BY error_rate DESC\nLIMIT 10;"
  },
  {
    "question": "分析VIVO和华为设备上的广告效果对比",
    "sql": "SELECT \n    brand,\n    COUNT(*) as impression_count,\n    SUM(CASE WHEN event = 'clk' THEN 1 ELSE 0 END) as click_count,\n    SUM(CASE WHEN event = 'clk' THEN 1 ELSE 0 END) / COUNT(*) as ctr\nFROM ods_RealTime_pcc_quickapp_events\nWHERE timed = '2025-04-15' \nAND event IN ('imp', 'clk')\nAND brand IN ('vivo', 'huawei')\nGROUP BY brand;"
  },
  {
    "question": "查询各类广告位的展示和点击情况",
    "sql": "SELECT \n    impPosition,\n    COUNT(*) as impression_count,\n    SUM(CASE WHEN event = 'clk' THEN 1 ELSE 0 END) as click_count,\n    SUM(CASE WHEN event = 'clk' THEN 1 ELSE 0 END) / COUNT(*) as ctr\nFROM ods_RealTime_pcc_quickapp_events\nWHERE timed = '2025-04-15' AND event IN ('imp', 'clk') AND impPosition IS NOT NULL\nGROUP BY impPosition\nORDER BY impression_count DESC;"
  },
  {
    "question": "分析不同网络类型下的广告加载性能",
    "sql": "SELECT \n    networkType,\n    AVG(CASE WHEN event = 'send2' AND errCode IS NULL THEN UNIX_TIMESTAMP(timedt) - clientTime/1000 ELSE NULL END) as avg_load_time_sec,\n    COUNT(*) as request_count,\n    SUM(CASE WHEN event = 'err' THEN 1 ELSE 0 END) as error_count,\n    SUM(CASE WHEN event = 'err' THEN 1 ELSE 0 END) / COUNT(*) as error_rate\nFROM ods_RealTime_pcc_quickapp_events\nWHERE timed = '2025-04-15' AND networkType IS NOT NULL\nGROUP BY networkType\nORDER BY request_count DESC;"
  },
  {
    "question": "查一下小米昨天的平均winPrice和今天的平均winPrice，顺便告诉我昨天和今天的哪个launchid的winPrice最高，在把他当时imp里最高的reqid也打印出来，IP地址和省份也给我打印出来，ip和省份在info里",
    "sql": "WITH daily_stats AS (\n    SELECT \n        timed,\n        AVG(winPrice) as avg_win_price,\n        MAX_BY(launchId, winPrice) as max_win_price_launchid,\n        MAX_BY(reqId, winPrice) as max_win_price_reqid,\n        MAX(winPrice) as max_win_price\n    FROM ods_RealTime_pcc_quickapp_events\n    WHERE timed IN (CURRENT_DATE(), DATE_SUB(CURRENT_DATE(), 1))\n        AND brand = 'xiaomi'\n        AND event = 'imp'\n        AND winPrice IS NOT NULL\n    GROUP BY timed\n)\nSELECT \n    ds.timed,\n    ds.avg_win_price,\n    ds.max_win_price_launchid,\n    ds.max_win_price_reqid,\n    ds.max_win_price,\n    info.IP as max_win_price_ip,\n    info.regionName as max_win_price_region\nFROM daily_stats ds\nLEFT JOIN ods_RealTime_pcc_quickapp_events info\n    ON ds.max_win_price_launchid = info.launchId\n    AND info.event = 'config'\n    AND info.timed = ds.timed\nORDER BY ds.timed DESC;"
  },
  {
    "question": "计算不同设备品牌的用户行为覆盖率",
    "sql": "SELECT \n    brand,\n    COUNT(DISTINCT uniqueId) as total_users,\n    COUNT(DISTINCT CASE WHEN event = 'imp' THEN uniqueId END) AS impuv,\n    COUNT(DISTINCT CASE WHEN event = 'clk' THEN uniqueId END) AS clkuv,\n    ROUND(COUNT(DISTINCT CASE WHEN event = 'imp' THEN uniqueId END) / COUNT(DISTINCT uniqueId), 2) AS exposure_user_ratio,\n    ROUND(COUNT(DISTINCT CASE WHEN event = 'clk' THEN uniqueId END) / COUNT(DISTINCT uniqueId), 2) AS click_user_ratio\nFROM ods_RealTime_pcc_quickapp_events\nWHERE timed = CURRENT_DATE()\nGROUP BY brand\nORDER BY total_users DESC\nLIMIT 10;"
  },
  {
    "question": "查找今天点击了链接但没有下载的用户",
    "sql": "SELECT DISTINCT u.userId, u.deviceId \nFROM ods_RealTime_pcc_quickapp_events u\nLEFT JOIN ods_RealTime_pcc_quickapp_events d ON u.userId = d.userId \n    AND d.event = 'download' \n    AND d.timed = CURRENT_DATE()\nWHERE u.timed = CURRENT_DATE()\n    AND u.event = 'click' \n    AND d.userId IS NULL;"
  },
  {
    "question": "查询今天有曝光但没有点击的广告ID",
    "sql": "SELECT DISTINCT i.adId, i.adName\nFROM ods_RealTime_pcc_quickapp_events i\nLEFT JOIN ods_RealTime_pcc_quickapp_events c ON i.adId = c.adId \n    AND c.event = 'click' \n    AND c.timed = CURRENT_DATE()\nWHERE i.timed = CURRENT_DATE()\n    AND i.event = 'impression' \n    AND c.adId IS NULL;"
  },
  {
    "question": "查询今天vivo用户首次曝光后有第二次曝光但没有点击过的记录",
    "sql": "WITH first_impressions AS (\n    SELECT\n        launchId,\n        reqId,\n        timedt AS first_imp_time \n    FROM\n        ods_RealTime_pcc_quickapp_events \n    WHERE\n        timed = CURRENT_DATE() \n        AND brand = 'vivo' \n        AND event = 'imp' \n),\nno_clicks AS (\n    SELECT\n        fi.launchId,\n        fi.reqId,\n        fi.first_imp_time \n    FROM\n        first_impressions fi\n        LEFT JOIN ods_RealTime_pcc_quickapp_events clk ON fi.launchId = clk.launchId \n            AND fi.reqId = clk.reqId \n            AND clk.event = 'clk' \n            AND clk.timed = CURRENT_DATE()\n    WHERE\n        clk.reqId IS NULL \n),\nsecond_impressions AS (\n    SELECT\n        nc.launchId,\n        nc.reqId,\n        nc.first_imp_time,\n        MIN(e.timedt) AS second_imp_time \n    FROM\n        no_clicks nc\n        JOIN ods_RealTime_pcc_quickapp_events e ON nc.launchId = e.launchId \n            AND e.event = 'imp'\n            AND e.timedt > nc.first_imp_time \n            AND e.timed = CURRENT_DATE()\n    GROUP BY\n        nc.launchId,\n        nc.reqId,\n        nc.first_imp_time \n)\nSELECT\n    si.launchId,\n    si.reqId,\n    si.first_imp_time,\n    si.second_imp_time \nFROM\n    second_impressions si \nORDER BY\n    si.first_imp_time \nLIMIT 10;"
  },
  {
    "question": "查找今天OPPO手机用户点击广告后10分钟内又返回了首页的用户",
    "sql": "WITH ad_clicks AS (\n    SELECT \n        userId, \n        deviceId, \n        timedt AS click_time\n    FROM ods_RealTime_pcc_quickapp_events\n    WHERE timed = CURRENT_DATE()\n        AND brand = 'OPPO'\n        AND event = 'click'\n        AND position = 'ad'\n)\nSELECT \n    ac.userId,\n    ac.deviceId,\n    ac.click_time AS ad_click_time,\n    hp.timedt AS homepage_time,\n    TIMESTAMPDIFF(SECOND, ac.click_time, hp.timedt) AS seconds_between\nFROM ad_clicks ac\nJOIN ods_RealTime_pcc_quickapp_events hp ON ac.userId = hp.userId\n    AND hp.event = 'pageview'\n    AND hp.page = 'homepage'\n    AND hp.timedt > ac.click_time\n    AND hp.timedt < DATE_ADD(ac.click_time, INTERVAL 10 MINUTE)\n    AND hp.timed = CURRENT_DATE()\nORDER BY ac.click_time\nLIMIT 20;"
  },
  {
    "question": "查询今天华为用户在应用中连续浏览了3个及以上页面的情况",
    "sql": "WITH user_pageviews AS (\n    SELECT\n        userId,\n        deviceId,\n        timedt,\n        page,\n        ROW_NUMBER() OVER (PARTITION BY userId ORDER BY timedt) AS view_sequence\n    FROM ods_RealTime_pcc_quickapp_events\n    WHERE timed = CURRENT_DATE()\n        AND brand = 'huawei'\n        AND event = 'pageview'\n),\nsequence_groups AS (\n    SELECT\n        userId,\n        deviceId,\n        MIN(timedt) AS start_time,\n        MAX(timedt) AS end_time,\n        COUNT(*) AS page_count,\n        GROUP_CONCAT(page ORDER BY timedt SEPARATOR ' -> ') AS page_path\n    FROM user_pageviews\n    GROUP BY userId, deviceId, (view_sequence - ROW_NUMBER() OVER (PARTITION BY userId ORDER BY timedt))\n    HAVING COUNT(*) >= 3\n)\nSELECT\n    userId,\n    deviceId,\n    start_time,\n    end_time,\n    page_count,\n    page_path\nFROM sequence_groups\nORDER BY page_count DESC, start_time\nLIMIT 20;"
  },
  {
    "question": "分析华为买乐多4.3.57版本的广告指标，包括用户覆盖率、点击率、收入和ECPM等核心指标",
    "sql": "WITH base AS (\n    -- 基础信息和指标计算的联合查询\n    SELECT \n        a.timed, \n        a.timeh, \n        a.packagename, \n        a.PCCSDKVersion,\n        a.launchid,\n        b.uniqueid,\n        b.traceid,\n        b.imp,\n        b.clk,\n        b.impuv,\n        b.clkuv,\n        b.layerImp,\n        b.bottomImp,\n        b.layerWinprice,\n        b.bottomWinprice,\n        b.winprice,\n        b.adbClk\n    FROM (\n        -- 获取华为买乐多4.3.57版本基础信息\n        SELECT DISTINCT \n            timed, timeh, packagename, PCCSDKVersion, launchid\n        FROM ods.ods_RealTime_pcc_quickapp_events\n        WHERE timed >= SUBDATE(CURDATE(), 0)\n            AND event = 'info'\n            AND brand = 'huawei'\n            AND packagename = 'com.multiple.shop'\n            AND PCCSDKVersion = '4.3.57'\n    ) a\n    LEFT JOIN (\n        -- 计算关键指标，保持与原SQL相同的事件筛选和计算逻辑\n        SELECT \n            timed, \n            launchid, \n            uniqueid, \n            userid,\n            traceid,\n            SUM(CASE WHEN event = 'info' THEN 1 ELSE 0 END) AS info,\n            SUM(CASE WHEN event = 'req2' THEN 1 ELSE 0 END) AS req2,\n            COUNT(DISTINCT CASE WHEN event = 'req2' THEN uniqueid END) AS req2uv,\n            SUM(CASE WHEN event = 'send2' THEN 1 ELSE 0 END) AS send2,\n            SUM(CASE WHEN event = 'imp' THEN 1 ELSE 0 END) AS imp,\n            COUNT(DISTINCT CASE WHEN event = 'imp' THEN uniqueid END) AS impuv,\n            SUM(CASE WHEN event = 'imp' AND (impPosition = 'layer' OR reqid LIKE 'layer%') THEN 1 ELSE 0 END) AS layerImp,\n            SUM(CASE WHEN event = 'imp' AND (impPosition = 'bottom' OR reqid LIKE 'bottom%') THEN 1 ELSE 0 END) AS bottomImp,\n            SUM(CASE WHEN event = 'imp' AND (impPosition = 'layer' OR reqid LIKE 'layer%') THEN winprice / 100000 ELSE 0 END) AS layerWinprice,\n            SUM(CASE WHEN event = 'imp' AND (impPosition = 'bottom' OR reqid LIKE 'bottom%') THEN winprice / 100000 ELSE 0 END) AS bottomWinprice,\n            SUM(CASE WHEN event = 'imp' THEN winprice / 100000 ELSE 0 END) AS winprice,\n            SUM(CASE WHEN event = 'clk' THEN 1 ELSE 0 END) AS clk,\n            COUNT(DISTINCT CASE WHEN event = 'clk' THEN uniqueid END) AS clkuv,\n            SUM(CASE WHEN event = 'clk' AND clkv = '2' THEN 1 ELSE 0 END) AS adbClk,\n            SUM(CASE WHEN event = 'cls' THEN 1 ELSE 0 END) AS cls,\n            SUM(CASE WHEN event = 'err' THEN 1 ELSE 0 END) AS err\n        FROM ods.ods_RealTime_pcc_quickapp_events\n        WHERE timed >= SUBDATE(CURDATE(), 0)\n            AND event IN ('info', 'req2', 'send2', 'imp', 'clk', 'cls', 'err')\n            AND launchid IN (\n                SELECT launchid FROM ods.ods_RealTime_pcc_quickapp_events\n                WHERE timed >= SUBDATE(CURDATE(), 0)\n                    AND event = 'info'\n                    AND brand = 'huawei'\n                    AND packagename = 'com.multiple.shop'\n                    AND PCCSDKVersion = '4.3.57'\n            )\n        GROUP BY timed, launchid, uniqueid, userid, traceid\n    ) b ON a.timed = b.timed AND a.launchid = b.launchid\n    LEFT JOIN (\n        SELECT\n            timed,\n            launchId,\n            sceneV4Name AS sceneName,\n            sceneid,\n            sceneV4AB\n        FROM\n            ods.ods_RealTime_pcc_quickapp_events\n        WHERE\n            timed >= SUBDATE(CURDATE(), 0)\n            AND event = 'config'\n    ) config ON config.timed = b.timed AND config.launchid = b.launchid\n)\nSELECT\n    timed,\n    timeh,\n    packagename,\n    PCCSDKVersion AS sdk,\n    COUNT(DISTINCT launchid) AS launchid_uv,\n    COUNT(DISTINCT traceid) AS traceid_uv,\n    COUNT(DISTINCT uniqueid) AS uniqueid_uv,\n    ROUND(SUM(impuv) / COUNT(DISTINCT uniqueid), 2) AS 曝光用户占比,\n    ROUND(SUM(clkuv) / COUNT(DISTINCT uniqueid), 2) AS 点击用户占比,\n    ROUND(SUM(imp) / COUNT(DISTINCT uniqueid), 2) AS ipuu,\n    ROUND(SUM(clk) / COUNT(DISTINCT uniqueid), 2) AS cpuu,\n    ROUND(SUM(winprice) / COUNT(DISTINCT uniqueid), 4) AS arpuu,\n    ROUND(SUM(imp) / COUNT(DISTINCT launchid), 2) AS ipul,\n    ROUND(SUM(clk) / COUNT(DISTINCT launchid), 2) AS cpul,\n    ROUND(SUM(winprice) / COUNT(DISTINCT launchid), 4) AS arpul,\n    ROUND(SUM(layerImp) / COUNT(DISTINCT launchid), 2) AS layer_ipul,\n    ROUND(SUM(bottomImp) / COUNT(DISTINCT launchid), 2) AS bottom_ipul,\n    ROUND(SUM(clk) / NULLIF(SUM(imp), 0), 2) AS ctr,\n    ROUND(SUM(clk) / NULLIF(SUM(layerImp), 0), 2) AS layer_ctr,\n    ROUND(SUM(adbClk) / NULLIF(SUM(clk), 0), 2) AS adb_rate,\n    ROUND(SUM(winprice), 2) AS preincome,\n    ROUND(SUM(winprice) / NULLIF(SUM(imp), 0) * 1000, 2) AS ecpm,\n    ROUND(SUM(layerWinprice) / NULLIF(SUM(layerImp), 0) * 1000, 2) AS layer_ecpm,\n    ROUND(SUM(bottomWinprice) / NULLIF(SUM(bottomImp), 0) * 1000, 2) AS bottom_ecpm,\n    ROUND(SUM(winprice) / NULLIF(SUM(clk), 0), 2) AS cpc\nFROM base\nWHERE timed >= SUBDATE(CURDATE(), 0)\nGROUP BY timed, timeh, packagename, PCCSDKVersion\nORDER BY timed, timeh;"
  },
  {
    "question": "解释广告分析中各指标的计算方法和意义",
    "sql": "-- 以下是主要广告指标的计算方法和解释\n-- 曝光用户占比 = 曝光用户数 / 总用户数\n-- 点击用户占比 = 点击用户数 / 总用户数\n-- ipuu (每用户曝光数) = 总曝光量 / 总用户数\n-- cpuu (每用户点击数) = 总点击量 / 总用户数\n-- arpuu (每用户收入) = 总收入 / 总用户数\n-- ipul (每次启动曝光数) = 总曝光量 / 总启动数\n-- cpul (每次启动点击数) = 总点击量 / 总启动数\n-- arpul (每次启动收入) = 总收入 / 总启动数\n-- layer_ipul (每次启动弹窗曝光数) = 弹窗曝光量 / 总启动数\n-- bottom_ipul (每次启动底部曝光数) = 底部曝光量 / 总启动数\n-- ctr (点击率) = 总点击量 / 总曝光量\n-- layer_ctr (弹窗点击率) = 总点击量 / 弹窗曝光量\n-- adb_rate (广告库点击率) = 广告库点击量 / 总点击量\n-- preincome (预估收入) = 总winprice值\n-- ecpm (千次曝光收入) = 总收入 / 总曝光量 * 1000\n-- layer_ecpm (弹窗千次曝光收入) = 弹窗收入 / 弹窗曝光量 * 1000\n-- bottom_ecpm (底部千次曝光收入) = 底部收入 / 底部曝光量 * 1000\n-- cpc (每次点击成本) = 总收入 / 总点击量"
  },
  {
    "question": "分析不同广告位置(弹窗和底部)的表现差异",
    "sql": "WITH base AS (\n    SELECT \n        timed,\n        packagename,\n        impPosition,\n        COUNT(DISTINCT reqid) AS impressions,\n        COUNT(DISTINCT CASE WHEN event = 'clk' THEN reqid END) AS clicks,\n        SUM(winprice / 100000) AS revenue\n    FROM ods.ods_RealTime_pcc_quickapp_events\n    WHERE timed >= SUBDATE(CURDATE(), 0)\n        AND event IN ('imp', 'clk')\n        AND brand = 'huawei'\n        AND packagename = 'com.multiple.shop'\n    GROUP BY timed, packagename, impPosition\n)\nSELECT\n    timed,\n    packagename,\n    impPosition,\n    impressions,\n    clicks,\n    ROUND(clicks / NULLIF(impressions, 0), 3) AS ctr,\n    revenue,\n    ROUND(revenue / NULLIF(impressions, 0) * 1000, 2) AS ecpm\nFROM base\nWHERE impPosition IN ('layer', 'bottom')\nORDER BY timed, packagename, impPosition;"
  },
  {
    "question": "按小时分析华为买乐多应用的广告指标",
    "sql": "SELECT\n    timed,\n    timeh,\n    packagename,\n    COUNT(DISTINCT launchid) AS launches,\n    COUNT(DISTINCT uniqueid) AS users,\n    SUM(CASE WHEN event = 'imp' THEN 1 ELSE 0 END) AS impressions,\n    SUM(CASE WHEN event = 'clk' THEN 1 ELSE 0 END) AS clicks,\n    ROUND(SUM(CASE WHEN event = 'clk' THEN 1 ELSE 0 END) / NULLIF(SUM(CASE WHEN event = 'imp' THEN 1 ELSE 0 END), 0), 3) AS ctr,\n    SUM(CASE WHEN event = 'imp' THEN winprice / 100000 ELSE 0 END) AS revenue,\n    ROUND(SUM(CASE WHEN event = 'imp' THEN winprice / 100000 ELSE 0 END) / NULLIF(SUM(CASE WHEN event = 'imp' THEN 1 ELSE 0 END), 0) * 1000, 2) AS ecpm\nFROM ods.ods_RealTime_pcc_quickapp_events\nWHERE timed >= SUBDATE(CURDATE(), 0)\n    AND event IN ('info', 'imp', 'clk')\n    AND brand = 'huawei'\n    AND packagename = 'com.multiple.shop'\nGROUP BY timed, timeh, packagename\nORDER BY timed, timeh;"
  },
  {
    "question": "解释广告分析中使用的各种术语和字段",
    "sql": "-- 广告分析中常用术语解释\n-- timed: 日期\n-- timeh: 小时\n-- packagename: 应用包名\n-- PCCSDKVersion: SDK版本号\n-- launchid: 启动ID，标识一次应用启动\n-- uniqueid: 用户唯一标识\n-- traceid: 追踪ID\n-- userid: 用户ID\n-- event: 事件类型，如info(基本信息)、req2(请求)、send2(发送)、imp(曝光)、clk(点击)、cls(关闭)、err(错误)\n-- impPosition: 广告曝光位置，如layer(弹窗)、bottom(底部)\n-- reqid: 请求ID\n-- winprice: 广告竞价价格，单位为分/100000\n-- clkv: 点击版本\n-- adbClk: 广告库点击\n-- impuv: 曝光用户数\n-- clkuv: 点击用户数\n-- ipuu: 每用户曝光数\n-- cpuu: 每用户点击数\n-- arpuu: 每用户收入\n-- ipul: 每次启动曝光数\n-- cpul: 每次启动点击数\n-- arpul: 每次启动收入\n-- ctr: 点击率\n-- ecpm: 千次曝光收入\n-- cpc: 每次点击成本"
  },
  {
    "question": "Query config events sceneV4Params as 'V4 scene strategy parameters', sceneV4Params Query info events timed between '2025-01-01' and '2025-04-15' and platformVersionCode2 not in ('90704','90703','90702','90700') Query req2 events Query send2 events Query imp events Query another send2 events Query clk events Query cls events Query err events Query all events and impPosition = 'bottom_jlq'",
    "sql": "select event,timedt,clientTime,launchid,clientParams as 'Client parameters',\nsecurityId as 'Security policy ID',\nsecurityName as 'Security policy name',\nsecurityParams as 'Security policy parameters',\nsceneV4Id as 'V4 scene strategy ID',\nsceneV4Name as 'V4 scene strategy name',\nsceneV4AB as 'V4 scene strategy AB group',\nuserGroupId as 'Current user group ID',\nuserGroupName as 'Current user group name',\nuserGroupParams as 'User stratification details',\nmediaId as 'Our media (application) ID',\nUA as 'User agent',\nIP as 'User IP',\ncityName as 'City name',\nregionName as 'Province name',\nmediaId,\nUA,\nIP,\ncityName,\nregionName,\nuniqueId,\nuserId,\nsourceCid,\nchannelId,\npackageName,\nbrand,\nPCCSDKVersion,\ntraceId,\naccountId,\nggBodyLevel1,\nggBodyLevel2,\nclientTime,\nonceStayTime\nfrom ods.ods_RealTime_pcc_quickapp_events\nwhere\ntimed = '2025-04-15'\nand launchid = (select launchId\nfrom ods.ods_RealTime_pcc_quickapp_events\nwhere\ntimed = '2025-04-15'\nand qaOAIDMD5 = 'ebe8294b43e225e142ca055b0c014a06'\nand event = 'info'\norder by clienttime desc\nlimit 1)\nand event = 'config'\norder by clienttime desc\nlimit 100\n;\nselect timedt,clientTime,launchid,channelId,PCCSDKVersion,platformVersionCode,platformVersionCode2,versionName,versionCode,packageName,brand,brand2,PCCSDKVersion,\nmanufacturer,model,osType,osVersionCode,osVersionName,\nplatformVersionName,screenWidth,screenHeight,deviceType,userId,qaOAIDMD5,qaDeviceIdMD5,\nqaAdvertisingIdMD5,idsErrInfo,networkType,sourcePackageName,sourceType,sourceExtra,\ntraceId,accountId,ggBodyLevel1,ggBodyLevel2,mediaSceneId,mediaSlotId,\nsourceCid,cidPath,extraParams,pageId,tId,lbId,launchAuto,launchType\nfrom ods_RealTime_pcc_quickapp_events\nwhere\ntimed = '2025-04-15'\nand event = 'info'\nand userid = '2391ffb6744bde42'\norder by clientTime  desc\nlimit 100\n;\nselect timedt,clientTime,pvid,avid,launchid,reqId,\nuserGroupId as 'Current user group ID',\nsceneV4Id as 'V4 scene strategy ID',\nggPlatform as 'Ad source',\nggId,\nggIdType as 'Ad code type'\nfrom ods.ods_RealTime_pcc_quickapp_events\nwhere\ntimed = '2025-03-'\nand event = 'req2'\nand launchid in (select launchId\nfrom ods.ods_RealTime_pcc_quickapp_events\nwhere\ntimed = '2025-03-26'\nand userid = 'b51e5e622dcd1e70'\nand event = 'info'\norder by clienttime desc\nlimit 30)\norder by clienttime desc\nlimit 50\n;\nselect timedt,clientTime,event,launchid,reqId,pvid,avid,brand,reqId,\nuserGroupId,\nsceneV4Id,\nggId,\nggIdType,\nggParams,\nggSource,\nggSourceType,\nggPlatform,\npoolType,\nerrCode,\nerrMsg,\nggTrueStyle,\nggPrePrice,\nggProPrice,\nbidPrice\nfrom ods.ods_RealTime_pcc_quickapp_events\nwhere\ntimed = '2025-02-27'\nand event = 'send2'\nand launchid in (select launchId\nfrom ods.ods_RealTime_pcc_quickapp_events\nwhere\ntimed = '2025-02-27'\nand userid = '7459f51d29de5961'\nand event = 'info'\norder by clienttime desc\nlimit 10)\norder by clienttime desc\nlimit 30\n;\nselect timedt,clientTime,event,launchid,pvid,avid,brand,reqId,\nuserGroupId,\nsceneV4Id,\nreqId,\nuserGroupId,\nsceneV4Id,\nggId,\nggIdType,\nggParams,\nggSource,\nggSourceType,\nggPlatform,\nggTrueStyle,\nimpPosition,\nimpV,\nimpT,\nimpW,\nisAct,\nlayerId,\nlayerBackgroundId,\nthenPoolCount,\npoolType,\nlayerLocation,\nwinSource,\nwinPrice,\ntargetCtr,\ncurrentCtr,\nimpDiff,\nreportAdClick\nfrom ods.ods_RealTime_pcc_quickapp_events\nwhere\ntimed = '2025-03-26'\nand event = 'imp'\nand launchid in (select launchId\nfrom ods.ods_RealTime_pcc_quickapp_events\nwhere\ntimed = '2025-03-26'\nand userid = '0b844ab2db4d00b4'\nand event = 'info'\norder by clienttime desc\nlimit 1000)\norder by clienttime desc\n;\nselect timedt,clientTime,event,launchid,reqId,\nuserGroupId,\nsceneV4Id,\nggId,\nggIdType,\nggParams,\nggSource,\nggSourceType,\nggPlatform as 'Added field',\npoolType,\nerrCode,\nerrMsg as 'Added field 2',\nggTrueStyle,\nggPrePrice,\nggProPrice,\nbidPrice,\nggStatus as 'Removed',\nggInteractionType,\ndpLink,\nggSourcePkgName,\nggAppInfo,\nggImgList,\nappPrivacyUrl,\npromotionPurpose,\npermissionUrl,\nhasPrivacy,\ncontentType\nfrom ods.ods_RealTime_pcc_quickapp_events\nwhere\ntimed = '2025-03-26'\nand event = 'send2'\nand launchid in (select launchId\nfrom ods.ods_RealTime_pcc_quickapp_events\nwhere\ntimed = '2025-03-26'\nand userid = 'e58cac56a55aae7f'\nand event = 'info'\norder by clienttime desc\nlimit 1000)\norder by clienttime desc\n;\nselect timedt,clientTime,event,launchid,reqId,\nuserGroupId,\nsceneV4Id,\nggId,\nggIdType,\nggParams,\nggSource,\nggSourceType,\nggPlatform,\nclkV,\nisAct,\nlayerId,\nreportAdClick,\nclickInfo,\nclkCount,\nisD1Act,\nggSourcePkgName,\nlayerBackgroundId,\nisAct\nfrom ods.ods_RealTime_pcc_quickapp_events\nwhere\ntimed = '2025-03-26'\nand event = 'clk'\nand launchid in (select launchId\nfrom ods.ods_RealTime_pcc_quickapp_events\nwhere\ntimed = '2025-03-26'\nand userid = 'b51e5e622dcd1e70'\nand event = 'info'\norder by clienttime desc\nlimit 1000)\norder by clienttime desc\n;\nselect timedt,clientTime,event,launchid,reqId,\nuserGroupId,\nsceneV4Id,\nggId,\nisEnded,\nclsType\nfrom ods.ods_RealTime_pcc_quickapp_events\nwhere\ntimed = '2025-03-26'\nand event = 'cls'\nand launchid in (select launchId\nfrom ods.ods_RealTime_pcc_quickapp_events\nwhere\ntimed = '2025-03-26'\nand userid = 'b51e5e622dcd1e70'\nand event = 'info'\norder by clienttime desc\nlimit 1000)\norder by clienttime desc\n;\nselect timedt,avid,pvid,brand,clientTime,event,launchid,reqId,\nuserGroupId,\nsceneV4Id,\nggId,\nerrCode,\nerrMsg\nfrom ods.ods_RealTime_pcc_quickapp_events\nwhere\ntimed = '2025-03-26'\nand event = 'err'\nand launchid in (select launchId\nfrom ods.ods_RealTime_pcc_quickapp_events\nwhere\ntimed = '2025-03-26'\nand userid = 'e58cac56a55aae7f'\nand event = 'info'\norder by clienttime desc\nlimit 1000)\norder by clienttime desc\nlimit 100\n;\nselect timedt,clientTime,event,page,reqId,thenPoolCount,ggId,poolType,ggStatus,ggSourceType,\n`ggParams`->'$.creativeType',`ggParams`->'$.isApp',\nggSource,impPosition,winSource,ggPrePrice,ggProPrice,bidPrice,winPrice,targetCtr,currentCtr,trigger,clsType,page,\nimpPosition,impV,impT,clkV,clsType,\nggIdType,ggStatus,ggSource,ggSourcePkgName,\nggPrePrice,ggProPrice,bidPrice,winPrice,targetCtr,currentCtr,errCode,errMsg\nfrom ods.ods_RealTime_pcc_quickapp_events\nwhere\ntimed = '2025-04-15'\nand launchid = (select launchId\nfrom ods.ods_RealTime_pcc_quickapp_events\nwhere\ntimed = '2025-04-15'\nand qaOAIDMD5 = 'ebe8294b43e225e142ca055b0c014a06'\nand event = 'info'\norder by clienttime desc\nlimit 1)"
  },
  {
    "question": "and poolType = 'incent_addExpPool' and event = 'clk' and ggSourceType = 'downloadApp' and clsType = 'replaced' and ggStatus = 'DOWNLOAD'",
    "sql": "and event in ('clk','imp')"
  },
  {
    "question": "and impPosition = 'bottom' and poolType = 'addExpPool' and brand = 'honor' and clkV = '98' and reqid = 'slotReqId-6113a7d9c47d96b1f581d975a22200db' Query users who clicked on phone complaint Query users who complained from sidebar Query users who clicked on settings and brand = 'huawei' Query source package names",
    "sql": "order by clienttime desc\nlimit 200\n;\nselect timedt,launchid,userid,brand,brand2,model,sourcePackageName,qaOAIDMD5\nFROM ods_RealTime_pcc_quickapp_events\nWHERE\ntimed = '2025-04-14'\nand timedt > '2025-04-14 08:50:00' and timedt < '2025-04-14 09:02:00'\nand launchid in (select launchid from ods_RealTime_pcc_quickapp_events where timedt > '2025-04-14 08:50:00' and event = 'clickHotline')\nand brand = 'huawei'\nand event = 'info'\norder by clienttime desc\nlimit 500\nselect timedt,launchid,userid,brand,brand2,model,sourcePackageName,qaOAIDMD5\nFROM ods_RealTime_pcc_quickapp_events\nWHERE\ntimed = '2025-04-14'\nand timedt > '2025-04-14 08:50:00' and timedt < '2025-04-14 09:02:00'\nand launchid in (select launchid from ods_RealTime_pcc_quickapp_events where timed = '2025-04-14' and timedt > '2025-04-14 08:50:00' and event = 'clickComplain'\nand launchid in (select launchid from ods_RealTime_pcc_quickapp_events where timed = '2025-04-14' and timedt > '2025-04-14 08:50:00' and event = 'info2' and regionName = '河北'\n) )\nand event = 'info'\nand brand = 'huawei'\nand model = 'HLK-AL00'\norder by clienttime desc\nlimit 100\nselect timedt,launchid,userid,PCCSDKVersion,brand,qaOAIDMD5\nFROM ods_RealTime_pcc_quickapp_events\nWHERE\ntimed = '2025-03-20'\nand launchid in (select launchId\nfrom ods_RealTime_pcc_quickapp_events\nwhere\ntimed = '2025-03-20'\nand event = 'goSet'\norder by clienttime desc\n)\nand event = 'info'\nand timedt > '2025-03-20 09:50:00' and timedt < '2025-03-20 09:58:00'\norder by clienttime\nlimit 20\nselect sourcePackageName,  count(*)as 'num'\nfrom ods_RealTime_pcc_quickapp_events\nwhere\ntimed = '2025-03-28'\nand brand = 'vivo'\nand event = 'info'\ngroup by 1\norder by 2 desc\nlimit 50\n```"
  },
  {
    "question": "查询ods_RealTime_pcc_quickapp_events表的所有字段",
    "sql": "SELECT * FROM ods_RealTime_pcc_quickapp_events LIMIT 10;"
  },
  {
    "question": "统计ods_RealTime_pcc_quickapp_events表的记录数",
    "sql": "SELECT COUNT(*) FROM ods_RealTime_pcc_quickapp_events;"
  },
  {
    "question": "查询ods_RealTime_pcc_quickapp_events表的前五个字段数据",
    "sql": "SELECT `ods_RealTime_pcc_quickapp_events`, `timed`, `timeh`, `event`, `launchId` FROM ods_RealTime_pcc_quickapp_events LIMIT 10;"
  }
]